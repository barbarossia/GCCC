# ææ¡ˆæ¨¡å—è¯¦ç»†è®¾è®¡æ–‡æ¡£

## 1. æ¨¡å—æ¦‚è¿°

ææ¡ˆæ¨¡å—æ˜¯ç¤¾åŒºæ²»ç†çš„æ ¸å¿ƒç»„ä»¶ï¼Œå…è®¸ç”¨æˆ·æäº¤å…³äºçºªå¿µå¸å‘è¡Œçš„ææ¡ˆï¼Œå¹¶å±•ç¤ºæ‰€æœ‰ææ¡ˆçš„è¯¦ç»†ä¿¡æ¯ã€‚è¯¥æ¨¡å—æ”¯æŒææ¡ˆçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œä»æäº¤åˆ°æŠ•ç¥¨å†åˆ°æ‰§è¡Œçš„å®Œæ•´æµç¨‹ã€‚

## 2. åŠŸèƒ½éœ€æ±‚

### 2.1 æ ¸å¿ƒåŠŸèƒ½
- **ææ¡ˆåˆ—è¡¨**: å±•ç¤ºå½“å‰è½®æ¬¡å’Œå†å²ææ¡ˆ
- **ææ¡ˆè¯¦æƒ…**: æŸ¥çœ‹ææ¡ˆçš„å®Œæ•´ä¿¡æ¯
- **ææ¡ˆæäº¤**: ç”¨æˆ·æäº¤æ–°çš„çºªå¿µå¸ææ¡ˆ
- **ææ¡ˆç­›é€‰**: æŒ‰çŠ¶æ€ã€æ—¶é—´ã€ç±»å‹ç­›é€‰ææ¡ˆ
- **ææ¡ˆæœç´¢**: å…³é”®è¯æœç´¢ææ¡ˆå†…å®¹
- **ææ¡ˆçŠ¶æ€**: å®æ—¶æ˜¾ç¤ºææ¡ˆçš„å½“å‰çŠ¶æ€

### 2.2 ææ¡ˆçŠ¶æ€ç®¡ç†
- **Draft**: è‰ç¨¿çŠ¶æ€ï¼Œå¯ç¼–è¾‘
- **Submitted**: å·²æäº¤ï¼Œç­‰å¾…å®¡æ ¸
- **Active**: è¿›å…¥æŠ•ç¥¨é˜¶æ®µ
- **Passed**: æŠ•ç¥¨é€šè¿‡
- **Rejected**: æŠ•ç¥¨æœªé€šè¿‡
- **Executed**: å·²æ‰§è¡Œé“¸å¸

### 2.3 æ—¶é—´å‘¨æœŸç®¡ç†
- **ææ¡ˆæœŸ**: æ¯æœˆ1-10æ—¥
- **æŠ•ç¥¨æœŸ**: æ¯æœˆ11-19æ—¥
- **æ‰§è¡ŒæœŸ**: æ¯æœˆ20-25æ—¥

## 3. æŠ€æœ¯å®ç°

### 3.1 æŠ€æœ¯æ ˆ
```javascript
{
  "@solana/web3.js": "^1.95.2",
  "react-hook-form": "^7.51.4",
  "react-dropzone": "^14.2.3",
  "react-markdown": "^9.0.1",
  "date-fns": "^3.6.0",
  "react-query": "^3.39.3",
  "axios": "^1.7.2"
}
```

### 3.2 ç»„ä»¶æ¶æ„
```
ProposalModule
â”œâ”€â”€ ProposalList (ææ¡ˆåˆ—è¡¨)
â”œâ”€â”€ ProposalCard (ææ¡ˆå¡ç‰‡)
â”œâ”€â”€ ProposalDetail (ææ¡ˆè¯¦æƒ…)
â”œâ”€â”€ ProposalForm (ææ¡ˆè¡¨å•)
â”œâ”€â”€ ProposalFilters (ææ¡ˆç­›é€‰)
â”œâ”€â”€ ProposalSearch (ææ¡ˆæœç´¢)
â”œâ”€â”€ ProposalTimeline (æ—¶é—´è½´)
â””â”€â”€ ProposalStats (ææ¡ˆç»Ÿè®¡)
```

### 3.3 æ ¸å¿ƒä»£ç ç»“æ„

#### 3.3.1 ææ¡ˆåˆ—è¡¨ä¸»ç»„ä»¶
```typescript
// components/proposal/ProposalList.tsx
import React, { useState, useMemo } from 'react';
import { useProposals } from '../../hooks/useProposals';
import { useWallet } from '@solana/wallet-adapter-react';
import { ProposalCard } from './ProposalCard';
import { ProposalFilters } from './ProposalFilters';
import { ProposalSearch } from './ProposalSearch';
import { ProposalTimeline } from './ProposalTimeline';
import { CreateProposalButton } from './CreateProposalButton';

export const ProposalList: React.FC = () => {
  const { publicKey, connected } = useWallet();
  const [filters, setFilters] = useState({
    status: 'all',
    round: 'current',
    sortBy: 'newest'
  });
  const [searchQuery, setSearchQuery] = useState('');

  const { 
    data: proposals, 
    loading, 
    error, 
    refetch 
  } = useProposals(filters);

  const filteredProposals = useMemo(() => {
    if (!proposals) return [];
    
    return proposals.filter(proposal => {
      const matchesSearch = searchQuery === '' || 
        proposal.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
        proposal.description.toLowerCase().includes(searchQuery.toLowerCase()) ||
        proposal.eventName.toLowerCase().includes(searchQuery.toLowerCase());
      
      return matchesSearch;
    });
  }, [proposals, searchQuery]);

  if (loading) {
    return (
      <div className="proposal-list-loading">
        <div className="loading-spinner"></div>
        <p>åŠ è½½ææ¡ˆä¸­...</p>
      </div>
    );
  }

  if (error) {
    return (
      <div className="proposal-list-error">
        <h3>åŠ è½½å¤±è´¥</h3>
        <p>{error}</p>
        <button onClick={refetch} className="retry-btn">
          é‡è¯•
        </button>
      </div>
    );
  }

  return (
    <div className="proposal-list">
      {/* é¡µé¢å¤´éƒ¨ */}
      <div className="proposal-header">
        <div className="header-content">
          <h1>ç¤¾åŒºææ¡ˆ</h1>
          <p>å…±åŒå†³å®šä¸‹ä¸€æšçºªå¿µå¸çš„å‘è¡Œ</p>
        </div>
        
        {/* æ—¶é—´è½´æ˜¾ç¤ºå½“å‰é˜¶æ®µ */}
        <ProposalTimeline />
        
        {/* åˆ›å»ºææ¡ˆæŒ‰é’® */}
        {connected && (
          <CreateProposalButton />
        )}
      </div>

      {/* ç­›é€‰å’Œæœç´¢ */}
      <div className="proposal-controls">
        <ProposalFilters 
          filters={filters}
          onFiltersChange={setFilters}
        />
        <ProposalSearch 
          value={searchQuery}
          onChange={setSearchQuery}
        />
      </div>

      {/* ææ¡ˆç»Ÿè®¡ */}
      <div className="proposal-stats">
        <div className="stat-item">
          <span className="stat-value">{filteredProposals.length}</span>
          <span className="stat-label">æ€»ææ¡ˆæ•°</span>
        </div>
        <div className="stat-item">
          <span className="stat-value">
            {filteredProposals.filter(p => p.status === 'Active').length}
          </span>
          <span className="stat-label">è¿›è¡Œä¸­</span>
        </div>
        <div className="stat-item">
          <span className="stat-value">
            {filteredProposals.filter(p => p.status === 'Passed').length}
          </span>
          <span className="stat-label">å·²é€šè¿‡</span>
        </div>
      </div>

      {/* ææ¡ˆåˆ—è¡¨ */}
      <div className="proposals-grid">
        {filteredProposals.map((proposal) => (
          <ProposalCard 
            key={proposal.id} 
            proposal={proposal}
            onVote={() => refetch()}
          />
        ))}
      </div>

      {/* ç©ºçŠ¶æ€ */}
      {filteredProposals.length === 0 && (
        <div className="empty-proposals">
          <div className="empty-icon">ğŸ“‹</div>
          <h3>æš‚æ— ææ¡ˆ</h3>
          <p>æˆä¸ºç¬¬ä¸€ä¸ªæäº¤ææ¡ˆçš„ç”¨æˆ·å§!</p>
          {connected && (
            <CreateProposalButton variant="primary" />
          )}
        </div>
      )}
    </div>
  );
};
```

#### 3.3.2 ææ¡ˆå¡ç‰‡ç»„ä»¶
```typescript
// components/proposal/ProposalCard.tsx
import React from 'react';
import { formatDistanceToNow, format } from 'date-fns';
import { zhCN } from 'date-fns/locale';
import { Proposal } from '../../types/proposal';
import { ProposalStatusBadge } from './ProposalStatusBadge';
import { VoteButton } from './VoteButton';

interface ProposalCardProps {
  proposal: Proposal;
  onVote?: () => void;
  className?: string;
}

export const ProposalCard: React.FC<ProposalCardProps> = ({ 
  proposal, 
  onVote,
  className = '' 
}) => {
  const timeRemaining = proposal.endTime ? 
    formatDistanceToNow(new Date(proposal.endTime), { 
      locale: zhCN, 
      addSuffix: true 
    }) : null;

  const votePercentage = proposal.totalStaked > 0 ? 
    (proposal.voteCount / proposal.totalStaked) * 100 : 0;

  return (
    <div className={`proposal-card ${className}`}>
      {/* å¡ç‰‡å¤´éƒ¨ */}
      <div className="card-header">
        <div className="proposal-meta">
          <ProposalStatusBadge status={proposal.status} />
          <span className="proposal-id">#{proposal.id}</span>
        </div>
        
        {timeRemaining && (
          <div className="time-remaining">
            {timeRemaining}
          </div>
        )}
      </div>

      {/* ææ¡ˆå›¾ç‰‡ */}
      {proposal.imageUrl && (
        <div className="proposal-image">
          <img 
            src={proposal.imageUrl} 
            alt={proposal.title}
            onError={(e) => {
              e.currentTarget.src = '/placeholder-coin.svg';
            }}
          />
        </div>
      )}

      {/* ææ¡ˆå†…å®¹ */}
      <div className="card-content">
        <h3 className="proposal-title">{proposal.title}</h3>
        
        <div className="proposal-event">
          <span className="event-label">çºªå¿µäº‹ä»¶:</span>
          <span className="event-name">{proposal.eventName}</span>
        </div>

        <p className="proposal-description">
          {proposal.description.length > 150 
            ? `${proposal.description.substring(0, 150)}...`
            : proposal.description
          }
        </p>

        {/* ææ¡ˆè€…ä¿¡æ¯ */}
        <div className="proposal-creator">
          <span className="creator-label">ææ¡ˆè€…:</span>
          <span className="creator-address">
            {proposal.creator.slice(0, 4)}...{proposal.creator.slice(-4)}
          </span>
        </div>

        {/* åˆ›å»ºæ—¶é—´ */}
        <div className="proposal-date">
          <span className="date-label">åˆ›å»ºæ—¶é—´:</span>
          <span className="date-value">
            {format(new Date(proposal.createTime), 'yyyyå¹´MMæœˆddæ—¥', { locale: zhCN })}
          </span>
        </div>
      </div>

      {/* æŠ•ç¥¨ä¿¡æ¯ */}
      {proposal.status === 'Active' && (
        <div className="voting-section">
          <div className="vote-stats">
            <div className="vote-count">
              <span className="count">{proposal.voteCount.toLocaleString()}</span>
              <span className="label">ç¥¨æ•°</span>
            </div>
            <div className="vote-percentage">
              <span className="percentage">{votePercentage.toFixed(1)}%</span>
              <span className="label">æ”¯æŒç‡</span>
            </div>
          </div>
          
          <div className="vote-progress">
            <div 
              className="progress-bar"
              style={{ width: `${votePercentage}%` }}
            />
          </div>
        </div>
      )}

      {/* å¡ç‰‡æ“ä½œ */}
      <div className="card-actions">
        <button 
          className="action-btn secondary"
          onClick={() => {
            // å¯¼èˆªåˆ°è¯¦æƒ…é¡µ
            window.location.href = `/proposals/${proposal.id}`;
          }}
        >
          æŸ¥çœ‹è¯¦æƒ…
        </button>
        
        {proposal.status === 'Active' && (
          <VoteButton 
            proposalId={proposal.id}
            onVoteSuccess={onVote}
          />
        )}
      </div>
    </div>
  );
};
```

#### 3.3.3 ææ¡ˆè¡¨å•ç»„ä»¶
```typescript
// components/proposal/ProposalForm.tsx
import React, { useState } from 'react';
import { useForm } from 'react-hook-form';
import { useDropzone } from 'react-dropzone';
import { useWallet } from '@solana/wallet-adapter-react';
import { submitProposal } from '../../services/proposalService';
import { ImageUploader } from './ImageUploader';
import { MarkdownEditor } from './MarkdownEditor';

interface ProposalFormData {
  title: string;
  eventName: string;
  description: string;
  imageFile?: File;
  coinDesign: string;
  reasoning: string;
}

export const ProposalForm: React.FC = () => {
  const { publicKey, signMessage } = useWallet();
  const [submitting, setSubmitting] = useState(false);
  const [imagePreview, setImagePreview] = useState<string>('');
  
  const {
    register,
    handleSubmit,
    formState: { errors },
    setValue,
    watch
  } = useForm<ProposalFormData>();

  const onSubmit = async (data: ProposalFormData) => {
    if (!publicKey || !signMessage) {
      toast.error('è¯·å…ˆè¿æ¥é’±åŒ…');
      return;
    }

    setSubmitting(true);
    try {
      // åˆ›å»ºç­¾åæ¶ˆæ¯
      const message = `æäº¤ææ¡ˆ: ${data.title}\næ—¶é—´: ${new Date().toISOString()}`;
      const messageBytes = new TextEncoder().encode(message);
      const signature = await signMessage(messageBytes);

      // æäº¤ææ¡ˆ
      await submitProposal({
        ...data,
        creator: publicKey.toString(),
        signature: Array.from(signature)
      });

      toast.success('ææ¡ˆæäº¤æˆåŠŸ!');
      // é‡å®šå‘åˆ°ææ¡ˆåˆ—è¡¨
      window.location.href = '/proposals';
      
    } catch (error) {
      console.error('æäº¤ææ¡ˆå¤±è´¥:', error);
      toast.error('æäº¤ææ¡ˆå¤±è´¥ï¼Œè¯·é‡è¯•');
    } finally {
      setSubmitting(false);
    }
  };

  return (
    <div className="proposal-form">
      <div className="form-header">
        <h2>æäº¤æ–°ææ¡ˆ</h2>
        <p>ä¸ºä¸‹ä¸€è½®çºªå¿µå¸å‘è¡Œæå‡ºæ‚¨çš„å»ºè®®</p>
      </div>

      <form onSubmit={handleSubmit(onSubmit)} className="proposal-form-content">
        {/* åŸºæœ¬ä¿¡æ¯ */}
        <div className="form-section">
          <h3>åŸºæœ¬ä¿¡æ¯</h3>
          
          <div className="form-group">
            <label htmlFor="title">ææ¡ˆæ ‡é¢˜ *</label>
            <input
              id="title"
              type="text"
              placeholder="ä¾‹å¦‚ï¼šçºªå¿µ2024å¹´å·´é»å¥¥è¿ä¼šå¼€å¹•å¼"
              {...register('title', { 
                required: 'è¯·è¾“å…¥ææ¡ˆæ ‡é¢˜',
                minLength: { value: 5, message: 'æ ‡é¢˜è‡³å°‘5ä¸ªå­—ç¬¦' },
                maxLength: { value: 100, message: 'æ ‡é¢˜ä¸è¶…è¿‡100ä¸ªå­—ç¬¦' }
              })}
              className={errors.title ? 'error' : ''}
            />
            {errors.title && (
              <span className="error-message">{errors.title.message}</span>
            )}
          </div>

          <div className="form-group">
            <label htmlFor="eventName">çºªå¿µäº‹ä»¶ *</label>
            <input
              id="eventName"
              type="text"
              placeholder="ç®€çŸ­æè¿°è¦çºªå¿µçš„äº‹ä»¶"
              {...register('eventName', { 
                required: 'è¯·è¾“å…¥çºªå¿µäº‹ä»¶',
                maxLength: { value: 50, message: 'äº‹ä»¶åç§°ä¸è¶…è¿‡50ä¸ªå­—ç¬¦' }
              })}
              className={errors.eventName ? 'error' : ''}
            />
            {errors.eventName && (
              <span className="error-message">{errors.eventName.message}</span>
            )}
          </div>
        </div>

        {/* è¯¦ç»†æè¿° */}
        <div className="form-section">
          <h3>è¯¦ç»†æè¿°</h3>
          
          <div className="form-group">
            <label htmlFor="description">ææ¡ˆæè¿° *</label>
            <MarkdownEditor
              value={watch('description') || ''}
              onChange={(value) => setValue('description', value)}
              placeholder="è¯¦ç»†æè¿°è¿™ä¸ªäº‹ä»¶çš„é‡è¦æ€§å’Œçºªå¿µæ„ä¹‰..."
            />
            {errors.description && (
              <span className="error-message">{errors.description.message}</span>
            )}
          </div>

          <div className="form-group">
            <label htmlFor="reasoning">ææ¡ˆç†ç”± *</label>
            <textarea
              id="reasoning"
              rows={4}
              placeholder="è¯´æ˜ä¸ºä»€ä¹ˆè¿™ä¸ªäº‹ä»¶å€¼å¾—å‘è¡Œçºªå¿µå¸..."
              {...register('reasoning', { 
                required: 'è¯·è¯´æ˜ææ¡ˆç†ç”±',
                minLength: { value: 50, message: 'ç†ç”±è‡³å°‘50ä¸ªå­—ç¬¦' }
              })}
              className={errors.reasoning ? 'error' : ''}
            />
            {errors.reasoning && (
              <span className="error-message">{errors.reasoning.message}</span>
            )}
          </div>
        </div>

        {/* çºªå¿µå¸è®¾è®¡ */}
        <div className="form-section">
          <h3>çºªå¿µå¸è®¾è®¡</h3>
          
          <div className="form-group">
            <label>è®¾è®¡å›¾ç‰‡ (å¯é€‰)</label>
            <ImageUploader
              onImageSelect={(file, preview) => {
                setValue('imageFile', file);
                setImagePreview(preview);
              }}
              preview={imagePreview}
            />
            <p className="form-hint">
              å»ºè®®ä¸Šä¼ æ–¹å½¢å›¾ç‰‡ï¼Œå¤§å°ä¸è¶…è¿‡5MBï¼Œæ”¯æŒ JPGã€PNG æ ¼å¼
            </p>
          </div>

          <div className="form-group">
            <label htmlFor="coinDesign">è®¾è®¡è¯´æ˜</label>
            <textarea
              id="coinDesign"
              rows={3}
              placeholder="æè¿°æ‚¨å¯¹çºªå¿µå¸å›¾æ¡ˆçš„è®¾è®¡æƒ³æ³•..."
              {...register('coinDesign')}
            />
          </div>
        </div>

        {/* æäº¤æŒ‰é’® */}
        <div className="form-actions">
          <button 
            type="button" 
            className="btn secondary"
            onClick={() => window.history.back()}
          >
            å–æ¶ˆ
          </button>
          <button 
            type="submit" 
            className="btn primary"
            disabled={submitting}
          >
            {submitting ? 'æäº¤ä¸­...' : 'æäº¤ææ¡ˆ'}
          </button>
        </div>
      </form>
    </div>
  );
};
```

#### 3.3.4 æ—¶é—´è½´ç»„ä»¶
```typescript
// components/proposal/ProposalTimeline.tsx
import React from 'react';
import { format, isAfter, isBefore } from 'date-fns';
import { zhCN } from 'date-fns/locale';
import { useCurrentPhase } from '../../hooks/useCurrentPhase';

export const ProposalTimeline: React.FC = () => {
  const { currentPhase, phaseEndTime, nextPhase } = useCurrentPhase();

  const phases = [
    {
      key: 'proposal',
      name: 'ææ¡ˆé˜¶æ®µ',
      description: 'ç¤¾åŒºæˆå‘˜æäº¤çºªå¿µå¸ææ¡ˆ',
      period: 'æ¯æœˆ1-10æ—¥',
      icon: 'ğŸ“'
    },
    {
      key: 'voting',
      name: 'æŠ•ç¥¨é˜¶æ®µ', 
      description: 'è´¨æŠ¼GCCCä»£å¸å‚ä¸æŠ•ç¥¨',
      period: 'æ¯æœˆ11-19æ—¥',
      icon: 'ğŸ—³ï¸'
    },
    {
      key: 'execution',
      name: 'æ‰§è¡Œé˜¶æ®µ',
      description: 'é“¸é€ è·èƒœææ¡ˆçš„çºªå¿µå¸',
      period: 'æ¯æœˆ20-25æ—¥',
      icon: 'ğŸ¯'
    }
  ];

  return (
    <div className="proposal-timeline">
      <div className="timeline-header">
        <h3>å½“å‰é˜¶æ®µ: {phases.find(p => p.key === currentPhase)?.name}</h3>
        {phaseEndTime && (
          <p className="phase-end">
            é˜¶æ®µç»“æŸ: {format(phaseEndTime, 'MMæœˆddæ—¥ HH:mm', { locale: zhCN })}
          </p>
        )}
      </div>

      <div className="timeline-track">
        {phases.map((phase, index) => {
          const isActive = phase.key === currentPhase;
          const isCompleted = phases.findIndex(p => p.key === currentPhase) > index;
          
          return (
            <div 
              key={phase.key}
              className={`timeline-phase ${isActive ? 'active' : ''} ${isCompleted ? 'completed' : ''}`}
            >
              <div className="phase-icon">
                {isCompleted ? 'âœ…' : phase.icon}
              </div>
              
              <div className="phase-content">
                <h4 className="phase-name">{phase.name}</h4>
                <p className="phase-description">{phase.description}</p>
                <span className="phase-period">{phase.period}</span>
              </div>
              
              {index < phases.length - 1 && (
                <div className={`phase-connector ${isCompleted ? 'completed' : ''}`} />
              )}
            </div>
          );
        })}
      </div>

      {nextPhase && (
        <div className="next-phase-info">
          <span>ä¸‹ä¸€é˜¶æ®µ: {phases.find(p => p.key === nextPhase)?.name}</span>
        </div>
      )}
    </div>
  );
};
```

## 4. æ•°æ®ç®¡ç†

### 4.1 ææ¡ˆæ•°æ®æ¥å£
```typescript
// types/proposal.ts
export interface Proposal {
  id: string;
  title: string;
  eventName: string;
  description: string;
  imageUrl?: string;
  coinDesign?: string;
  reasoning: string;
  creator: string;
  createTime: string;
  startTime?: string;
  endTime?: string;
  status: ProposalStatus;
  voteCount: number;
  totalStaked: number;
  round: number;
}

export type ProposalStatus = 
  | 'Draft' 
  | 'Submitted' 
  | 'Active' 
  | 'Passed' 
  | 'Rejected' 
  | 'Executed';

export interface ProposalFilters {
  status: string;
  round: string;
  sortBy: string;
}

export interface CreateProposalRequest {
  title: string;
  eventName: string;
  description: string;
  imageFile?: File;
  coinDesign?: string;
  reasoning: string;
  creator: string;
  signature: number[];
}
```

### 4.2 ææ¡ˆæœåŠ¡
```typescript
// services/proposalService.ts
import axios from 'axios';
import { Proposal, CreateProposalRequest, ProposalFilters } from '../types/proposal';

const API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;

export const fetchProposals = async (filters: ProposalFilters): Promise<Proposal[]> => {
  const params = new URLSearchParams();
  
  if (filters.status !== 'all') {
    params.append('status', filters.status);
  }
  if (filters.round !== 'all') {
    params.append('round', filters.round);
  }
  params.append('sortBy', filters.sortBy);

  const response = await axios.get(`${API_BASE_URL}/proposals?${params}`);
  return response.data;
};

export const fetchProposalById = async (id: string): Promise<Proposal> => {
  const response = await axios.get(`${API_BASE_URL}/proposals/${id}`);
  return response.data;
};

export const submitProposal = async (data: CreateProposalRequest): Promise<string> => {
  const formData = new FormData();
  
  formData.append('title', data.title);
  formData.append('eventName', data.eventName);
  formData.append('description', data.description);
  formData.append('reasoning', data.reasoning);
  formData.append('creator', data.creator);
  formData.append('signature', JSON.stringify(data.signature));
  
  if (data.imageFile) {
    formData.append('image', data.imageFile);
  }
  if (data.coinDesign) {
    formData.append('coinDesign', data.coinDesign);
  }

  const response = await axios.post(`${API_BASE_URL}/proposals`, formData, {
    headers: {
      'Content-Type': 'multipart/form-data',
    },
  });
  
  return response.data.id;
};

export const getCurrentPhase = async (): Promise<{
  phase: string;
  endTime: string;
  nextPhase: string;
}> => {
  const response = await axios.get(`${API_BASE_URL}/governance/current-phase`);
  return response.data;
};
```

### 4.3 è‡ªå®šä¹‰ Hooks
```typescript
// hooks/useProposals.ts
import { useQuery } from 'react-query';
import { ProposalFilters } from '../types/proposal';
import { fetchProposals } from '../services/proposalService';

export const useProposals = (filters: ProposalFilters) => {
  return useQuery(
    ['proposals', filters],
    () => fetchProposals(filters),
    {
      staleTime: 30000, // 30ç§’
      cacheTime: 300000, // 5åˆ†é’Ÿ
      refetchInterval: 60000, // 1åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
    }
  );
};

// hooks/useCurrentPhase.ts
import { useQuery } from 'react-query';
import { getCurrentPhase } from '../services/proposalService';

export const useCurrentPhase = () => {
  const { data } = useQuery(
    ['currentPhase'],
    getCurrentPhase,
    {
      staleTime: 60000, // 1åˆ†é’Ÿ
      refetchInterval: 60000,
    }
  );

  return {
    currentPhase: data?.phase || 'proposal',
    phaseEndTime: data?.endTime ? new Date(data.endTime) : null,
    nextPhase: data?.nextPhase || null,
  };
};
```

## 5. UI/UX è®¾è®¡è¦æ±‚

### 5.1 è§†è§‰è®¾è®¡
- **å¡ç‰‡å¼å¸ƒå±€**: ä½¿ç”¨å¡ç‰‡å±•ç¤ºææ¡ˆä¿¡æ¯
- **çŠ¶æ€æŒ‡ç¤º**: æ¸…æ™°çš„è§†è§‰çŠ¶æ€æ ‡è¯†
- **æ—¶é—´è½´**: ç›´è§‚çš„é˜¶æ®µè¿›åº¦å±•ç¤º
- **å“åº”å¼ç½‘æ ¼**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸

### 5.2 äº¤äº’è®¾è®¡
- **ç­›é€‰åŠŸèƒ½**: å¤šç»´åº¦ç­›é€‰ææ¡ˆ
- **æœç´¢åŠŸèƒ½**: å®æ—¶æœç´¢ææ¡ˆå†…å®¹
- **è¡¨å•éªŒè¯**: å®æ—¶éªŒè¯å’Œå‹å¥½æç¤º
- **å›¾ç‰‡ä¸Šä¼ **: æ‹–æ‹½ä¸Šä¼ å’Œé¢„è§ˆåŠŸèƒ½

### 5.3 çŠ¶æ€åé¦ˆ
```css
/* ææ¡ˆçŠ¶æ€æ ·å¼ */
.proposal-status {
  &.draft { color: #6b7280; background: #f3f4f6; }
  &.submitted { color: #059669; background: #d1fae5; }
  &.active { color: #dc2626; background: #fee2e2; }
  &.passed { color: #16a34a; background: #dcfce7; }
  &.rejected { color: #9ca3af; background: #f9fafb; }
  &.executed { color: #7c3aed; background: #ede9fe; }
}
```

## 6. æ€§èƒ½ä¼˜åŒ–

### 6.1 è™šæ‹ŸåŒ–æ»šåŠ¨
```typescript
// å¯¹äºå¤§é‡ææ¡ˆçš„æ€§èƒ½ä¼˜åŒ–
import { FixedSizeList as List } from 'react-window';

const VirtualizedProposalList: React.FC<{ proposals: Proposal[] }> = ({ proposals }) => {
  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => (
    <div style={style}>
      <ProposalCard proposal={proposals[index]} />
    </div>
  );

  return (
    <List
      height={600}
      itemCount={proposals.length}
      itemSize={300}
      width="100%"
    >
      {Row}
    </List>
  );
};
```

### 6.2 å›¾ç‰‡ä¼˜åŒ–
```typescript
// å›¾ç‰‡æ‡’åŠ è½½å’Œå‹ç¼©
const OptimizedImage: React.FC<{ src: string; alt: string }> = ({ src, alt }) => {
  const [loaded, setLoaded] = useState(false);
  
  return (
    <div className="image-container">
      {!loaded && <div className="image-placeholder" />}
      <img
        src={src}
        alt={alt}
        loading="lazy"
        onLoad={() => setLoaded(true)}
        style={{ display: loaded ? 'block' : 'none' }}
      />
    </div>
  );
};
```

## 7. å®‰å…¨è€ƒè™‘

### 7.1 è¾“å…¥éªŒè¯
- **XSS é˜²æŠ¤**: å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒHTMLè½¬ä¹‰
- **æ–‡ä»¶ä¸Šä¼ **: éªŒè¯æ–‡ä»¶ç±»å‹å’Œå¤§å°
- **å†…å®¹å®¡æ ¸**: æ•æ„Ÿè¯è¿‡æ»¤

### 7.2 èº«ä»½éªŒè¯
```typescript
// ææ¡ˆæäº¤æ—¶çš„ç­¾åéªŒè¯
const verifyProposalSignature = async (
  proposal: CreateProposalRequest,
  publicKey: PublicKey
): Promise<boolean> => {
  const message = `æäº¤ææ¡ˆ: ${proposal.title}\næ—¶é—´: ${proposal.createTime}`;
  const messageBytes = new TextEncoder().encode(message);
  
  try {
    const signature = new Uint8Array(proposal.signature);
    return nacl.sign.detached.verify(messageBytes, signature, publicKey.toBytes());
  } catch {
    return false;
  }
};
```

## 8. æµ‹è¯•ç­–ç•¥

### 8.1 ç»„ä»¶æµ‹è¯•
```typescript
// __tests__/ProposalCard.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { ProposalCard } from '../ProposalCard';

describe('ProposalCard', () => {
  const mockProposal = {
    id: '1',
    title: 'æµ‹è¯•ææ¡ˆ',
    eventName: 'æµ‹è¯•äº‹ä»¶',
    description: 'æµ‹è¯•æè¿°',
    status: 'Active' as const,
    voteCount: 1000,
    totalStaked: 10000,
    // ...
  };

  test('æ˜¾ç¤ºææ¡ˆä¿¡æ¯', () => {
    render(<ProposalCard proposal={mockProposal} />);
    
    expect(screen.getByText('æµ‹è¯•ææ¡ˆ')).toBeInTheDocument();
    expect(screen.getByText('æµ‹è¯•äº‹ä»¶')).toBeInTheDocument();
    expect(screen.getByText('10.0%')).toBeInTheDocument(); // æ”¯æŒç‡
  });

  test('å¤„ç†æŠ•ç¥¨æ“ä½œ', () => {
    const mockOnVote = jest.fn();
    render(<ProposalCard proposal={mockProposal} onVote={mockOnVote} />);
    
    fireEvent.click(screen.getByText('æŠ•ç¥¨'));
    // éªŒè¯æŠ•ç¥¨é€»è¾‘...
  });
});
```

### 8.2 é›†æˆæµ‹è¯•
```typescript
// __tests__/ProposalFlow.test.tsx
describe('ææ¡ˆæµç¨‹æµ‹è¯•', () => {
  test('å®Œæ•´ææ¡ˆæäº¤æµç¨‹', async () => {
    // æµ‹è¯•ä»åˆ›å»ºåˆ°æäº¤çš„å®Œæ•´æµç¨‹
  });

  test('ææ¡ˆçŠ¶æ€å˜æ›´', async () => {
    // æµ‹è¯•ææ¡ˆçŠ¶æ€çš„æ­£ç¡®å˜æ›´
  });
});
```

## 9. éƒ¨ç½²é…ç½®

### 9.1 ç¯å¢ƒå˜é‡
```env
# .env.local
NEXT_PUBLIC_API_BASE_URL=https://api.gccc.com
NEXT_PUBLIC_SOLANA_RPC_ENDPOINT=https://api.mainnet-beta.solana.com
NEXT_PUBLIC_UPLOAD_MAX_SIZE=5242880
NEXT_PUBLIC_ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/webp
```

### 9.2 CDN é…ç½®
```javascript
// next.config.js
module.exports = {
  images: {
    domains: ['cdn.gccc.com'],
    loader: 'cloudinary',
    path: 'https://res.cloudinary.com/gccc/',
  },
};
```
