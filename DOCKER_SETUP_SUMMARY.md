# GCCC Docker æ–‡ä»¶ç”Ÿæˆå®Œæˆæ€»ç»“

## ğŸ“¦ å·²åˆ›å»ºçš„æ–‡ä»¶

### 1. Backend Docker é…ç½®

```
src/backend/
â”œâ”€â”€ Dockerfile              # å¤šé˜¶æ®µæ„å»ºï¼Œæ”¯æŒå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒ
â”œâ”€â”€ .dockerignore           # æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
â””â”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹ï¼ˆå·²å­˜åœ¨ï¼‰
```

### 2. Database Docker é…ç½®

```
src/database/
â”œâ”€â”€ Dockerfile              # PostgreSQL 15 + åˆå§‹åŒ–è„šæœ¬
â””â”€â”€ .dockerignore           # æ’é™¤æ–‡æ¡£å’Œä¸´æ—¶æ–‡ä»¶
```

### 3. é¡¹ç›®æ ¹ç›®å½•æ–‡ä»¶

```
./
â”œâ”€â”€ docker-compose.yml      # å®Œæ•´æœåŠ¡æ ˆç¼–æ’
â”œâ”€â”€ .env.example            # Dockerç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ docker-deploy.sh        # Linux/macOS å¿«é€Ÿéƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker-deploy.ps1       # Windows PowerShell éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ DOCKER_DEPLOYMENT.md    # è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
â””â”€â”€ nginx/
    â””â”€â”€ conf.d/
        â””â”€â”€ gccc.conf       # Nginx åå‘ä»£ç†é…ç½®
```

## ğŸ—ï¸ Docker æ¶æ„è®¾è®¡

### Backend Dockerfile ç‰¹æ€§

- âœ… **å¤šé˜¶æ®µæ„å»º**: å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒåˆ†ç¦»
- âœ… **å®‰å…¨ä¼˜åŒ–**: éç‰¹æƒç”¨æˆ·è¿è¡Œ
- âœ… **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨ç›‘æ§æœåŠ¡çŠ¶æ€
- âœ… **ä½“ç§¯ä¼˜åŒ–**: åŸºäº Alpine Linux
- âœ… **çƒ­é‡è½½æ”¯æŒ**: å¼€å‘ç¯å¢ƒæ”¯æŒä»£ç çƒ­æ›´æ–°
- âœ… **è°ƒè¯•æ”¯æŒ**: å¼€æ”¾è°ƒè¯•ç«¯å£

### Database Dockerfile ç‰¹æ€§

- âœ… **è‡ªåŠ¨åˆå§‹åŒ–**: æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰ SQL è„šæœ¬
- âœ… **å¥åº·æ£€æŸ¥**: éªŒè¯æ•°æ®åº“è¡¨å’ŒåŠŸèƒ½
- âœ… **å¤‡ä»½æ¢å¤**: å†…ç½®å¤‡ä»½å’Œæ¢å¤è„šæœ¬
- âœ… **æ€§èƒ½ä¼˜åŒ–**: PostgreSQL ç”Ÿäº§ç¯å¢ƒå‚æ•°
- âœ… **ç›‘æ§å°±ç»ª**: å¯ç”¨ç»Ÿè®¡ä¿¡æ¯æ”¶é›†
- âœ… **æ•°æ®æŒä¹…åŒ–**: é…ç½®æ•°æ®å·

### Docker Compose æœåŠ¡æ ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Nginx    â”‚â”€â”€â”€â”€â”‚   Backend   â”‚â”€â”€â”€â”€â”‚ PostgreSQL  â”‚
â”‚  (å¯é€‰ä»£ç†)  â”‚    â”‚  Node.js API â”‚    â”‚   æ•°æ®åº“    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚    Redis    â”‚
                   â”‚    ç¼“å­˜     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ éƒ¨ç½²æ¨¡å¼

### 1. å¼€å‘æ¨¡å¼

```bash
# Linux/macOS
./docker-deploy.sh start dev

# Windows
.\docker-deploy.ps1 start dev
```

**ç‰¹æ€§:**

- ä»£ç çƒ­é‡è½½
- è°ƒè¯•ç«¯å£å¼€æ”¾
- è¯¦ç»†æ—¥å¿—è¾“å‡º
- å¼€å‘ä¾èµ–å®‰è£…

### 2. ç”Ÿäº§æ¨¡å¼

```bash
# Linux/macOS
./docker-deploy.sh start prod

# Windows
.\docker-deploy.ps1 start prod
```

**ç‰¹æ€§:**

- ä¼˜åŒ–çš„é•œåƒå¤§å°
- å®‰å…¨é…ç½®
- å¥åº·æ£€æŸ¥
- è‡ªåŠ¨é‡å¯

### 3. å®Œæ•´ç”Ÿäº§æ¨¡å¼ (å« Nginx)

```bash
# Linux/macOS
./docker-deploy.sh start nginx

# Windows
.\docker-deploy.ps1 start nginx
```

**ç‰¹æ€§:**

- Nginx åå‘ä»£ç†
- SSL/TLS æ”¯æŒ
- è´Ÿè½½å‡è¡¡å°±ç»ª
- é™æ€æ–‡ä»¶æœåŠ¡

## ğŸ“‹ é…ç½®è¦ç‚¹

### ç¯å¢ƒå˜é‡é…ç½®

ä¸»è¦é…ç½®é¡¹ (åœ¨ `.env` æ–‡ä»¶ä¸­)ï¼š

```bash
# æ•°æ®åº“å®‰å…¨
DB_PASSWORD=your_secure_password

# JWT å®‰å…¨
JWT_SECRET=your_jwt_secret_32_chars_minimum
REFRESH_TOKEN_SECRET=your_refresh_secret

# Solana é…ç½®
SOLANA_NETWORK=devnet  # æˆ– mainnet-beta
GCCC_TOKEN_MINT=your_token_address
TREASURY_WALLET=your_treasury_address

# CORS é…ç½®
CORS_ORIGIN=https://your-frontend-domain.com
```

### å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] æ›´æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
- [ ] è®¾ç½®å¼º JWT å¯†é’¥ (è‡³å°‘ 32 å­—ç¬¦)
- [ ] é…ç½®æ­£ç¡®çš„ CORS åŸŸå
- [ ] å¯ç”¨ SSL è¯ä¹¦ (ç”Ÿäº§ç¯å¢ƒ)
- [ ] é…ç½®é˜²ç«å¢™è§„åˆ™
- [ ] é™åˆ¶æ•°æ®åº“è®¿é—®
- [ ] è®¾ç½®å¤‡ä»½ç­–ç•¥

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### å¿«é€Ÿå¯åŠ¨

```bash
# ä¸€é”®éƒ¨ç½² (Linux/macOS)
./docker-deploy.sh start

# ä¸€é”®éƒ¨ç½² (Windows)
.\docker-deploy.ps1 start
```

### å¸¸ç”¨æ“ä½œ

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f database

# åˆ›å»ºæ•°æ®åº“å¤‡ä»½
docker-compose exec database /scripts/backup.sh

# å¥åº·æ£€æŸ¥
docker-compose exec database /scripts/health_check.sh
curl http://localhost:3000/health
```

### ç»´æŠ¤æ“ä½œ

```bash
# é‡å¯æœåŠ¡
docker-compose restart

# æ›´æ–°é•œåƒ
docker-compose build --no-cache
docker-compose up -d

# æ¸…ç†èµ„æº
docker-compose down -v  # åŒ…å«æ•°æ®å·
```

## ğŸ“Š æ€§èƒ½é…ç½®

### èµ„æºé™åˆ¶å»ºè®®

#### æœ€å°é…ç½® (å¼€å‘/æµ‹è¯•)

- **CPU**: 2 æ ¸å¿ƒ
- **å†…å­˜**: 4GB
- **å­˜å‚¨**: 20GB

#### æ¨èé…ç½® (ç”Ÿäº§ç¯å¢ƒ)

- **CPU**: 4 æ ¸å¿ƒ+
- **å†…å­˜**: 8GB+
- **å­˜å‚¨**: 50GB SSD

### PostgreSQL ä¼˜åŒ–

æ•°æ®åº“å®¹å™¨åŒ…å«ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å‚æ•°ï¼š

```sql
max_connections = 200
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 4MB
maintenance_work_mem = 64MB
```

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### å¥åº·æ£€æŸ¥

- **æ•°æ®åº“**: è‡ªåŠ¨éªŒè¯è¡¨æ•°é‡å’Œè¿æ¥çŠ¶æ€
- **API**: HTTP å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **å®¹å™¨**: Docker åŸç”Ÿå¥åº·æ£€æŸ¥

### æ—¥å¿—ç®¡ç†

- **åº”ç”¨æ—¥å¿—**: `/app/logs/` (åç«¯å®¹å™¨)
- **æ•°æ®åº“æ—¥å¿—**: PostgreSQL æ ‡å‡†æ—¥å¿—
- **Nginx æ—¥å¿—**: `/var/log/nginx/` (å¦‚æœå¯ç”¨)

### è°ƒè¯•æ¨¡å¼

å¼€å‘ç¯å¢ƒæ”¯æŒï¼š

- Node.js è°ƒè¯•ç«¯å£ (9229)
- å®æ—¶ä»£ç é‡è½½
- è¯¦ç»†é”™è¯¯è¾“å‡º

## ğŸ“ åç»­æ­¥éª¤

1. **æµ‹è¯•éƒ¨ç½²**

   ```bash
   ./docker-deploy.sh start
   curl http://localhost:3000/health
   ```

2. **é…ç½®ç”Ÿäº§ç¯å¢ƒ**

   - ç¼–è¾‘ `.env` æ–‡ä»¶
   - é…ç½® SSL è¯ä¹¦
   - è®¾ç½®åŸŸåè§£æ

3. **è®¾ç½® CI/CD**

   - GitHub Actions
   - è‡ªåŠ¨åŒ–æµ‹è¯•
   - è‡ªåŠ¨éƒ¨ç½²æµç¨‹

4. **ç›‘æ§é…ç½®**
   - Prometheus + Grafana
   - æ—¥å¿—èšåˆ
   - å‘Šè­¦ç³»ç»Ÿ

## ğŸ‰ å®ŒæˆçŠ¶æ€

âœ… **Backend Docker é…ç½®** - å®Œæ•´çš„å¤šé˜¶æ®µæ„å»ºé…ç½®  
âœ… **Database Docker é…ç½®** - è‡ªåŠ¨åˆå§‹åŒ–å’Œç®¡ç†è„šæœ¬  
âœ… **Docker Compose ç¼–æ’** - å®Œæ•´æœåŠ¡æ ˆé…ç½®  
âœ… **ç¯å¢ƒå˜é‡ç®¡ç†** - å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒåˆ†ç¦»  
âœ… **éƒ¨ç½²è„šæœ¬** - è·¨å¹³å°è‡ªåŠ¨åŒ–éƒ¨ç½²  
âœ… **æ–‡æ¡£å’ŒæŒ‡å—** - è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜  
âœ… **å®‰å…¨é…ç½®** - ç”Ÿäº§ç¯å¢ƒå®‰å…¨æœ€ä½³å®è·µ

GCCC DApp ç°åœ¨å·²ç»å…·å¤‡å®Œæ•´çš„å®¹å™¨åŒ–éƒ¨ç½²èƒ½åŠ›ï¼ğŸš€
